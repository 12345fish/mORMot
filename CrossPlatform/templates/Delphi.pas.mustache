/// this unit has been generated by a tool - do not modify it by hand
// - retrieved from http://{{host}}/{{uri}}
// at {{time}} using "{{templatename}}" template
unit {{filename}};

interface

uses
  SynCommons,
  mORMot;

{{! recursive partials used to write records type definition}}
{{<writerec}}record
{{#fields}}
    {{propname}}: {{#typeName}}{{typeName}}{{/typeName}}{{#isRecord}}{{>writerec}}{{/isRecord}}{{#isSimpleArray}}array of {{typeName}}{{/isSimpleArray}}{{#isRecordArray}}[{{>writerec}}{{/isRecordArray}};
{{/fields}}
  end;
{{/writerec}}
{{<textrec}}{{#fields}}{{propname}} {{#typeName}}{{typeName}}{{/typeName}}{{#isRecord}}{ {{>textrec}} }{{/isRecord}}{{#isSimpleArray}}array of {{typeName}}{{/isSimpleArray}}{{#isRecordArray}}[ {{>textrec}} ]{{/isRecordArray}} {{/fields}}{{/textrec}}
{{#withRecords}}
type // define some record types, used as properties below
  {{#records}}
  {{name}} = {{>writerec}} 
  {{/records}}
{{/withRecords}}
type
  {{#orm}}
  {{^isinmormotpas}}
  /// map "{{tablename}}" table
  {{className}} = class(TSQLRecord)
  protected
    {{#fields}}
    f{{name}}: {{typeRttiName}}; 
    {{/fields}}
  {{#hasRecords}}
    class procedure InternalRegisterCustomProperties(Props: TSQLRecordProperties); override;
  public
    {{#fields}}
    {{#isrecord}}
    property {{name}}: {{typeRttiName}} read f{{name}} write f{{name}}{{#unique}} stored AS_UNIQUE{{/unique}};
    {{/isrecord}}
    {{/fields}}
  {{/hasRecords}}
  published
    {{#fields}}
    {{^isrecord}}
    property {{name}}: {{typeRttiName}}{{#width}} index {{width}}{{/width}} read f{{name}} write f{{name}}{{#unique}} stored AS_UNIQUE{{/unique}};
    {{/isrecord}}
    {{/fields}}
  end;
  
  {{/isinmormotpas}}
  {{/orm}}
  
/// return the database Model corresponding to this server
function GetModel: TSQLModel;

{{#port}}
const
  /// the server port, corresponding to http://{{host}}
  SERVER_PORT = {{port}};

{{/port}}

implementation

{{#orm}}
{{#hasRecords}}
{ {{className}} }

class procedure {{className}}.InternalRegisterCustomProperties(
  Props: TSQLRecordProperties);
begin
{{#fields}}
{{#isrecord}}
  Props.RegisterCustomPropertyFromRTTI(Self,TypeInfo({{typeRttiName}}),
    '{{name}}',@{{className}}(nil).f{{name}});
{{/isrecord}}
{{/fields}}
end;

{{/hasRecords}}
{{/orm}}

function GetModel: TSQLModel;
begin
  result := TSQLModel.Create([{{#orm}}{{className}}{{comma}}{{/orm}}],'{{root}}');
end;

{{#withRecords}}
const
{{#records}}
  __{{name}} = '{{>textrec}}';
{{/records}}

initialization
{{#records}}
  TTextWriter.RegisterCustomJSONSerializerFromText(
    TypeInfo({{name}}),__{{name}});
{{/records}}
{{/withRecords}}
end.